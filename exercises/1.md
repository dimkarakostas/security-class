# 1η άσκηση

Σκοπός της άσκησης είναι να εξασκηθείτε στη χρήση του προγράμματος **gpg**.
Γι' αυτή την άσκηση θα χρειαστείς τουλάχιστον ένα συνεργάτη.

## Εγκατάσταση του gpg

Κατέβασε και εγκατάστησε το gpg.

### Linux
Σε περίπτωση που είσαι σε Linux, πιθανώς το έχεις ήδη. Δοκίμασε να γράψεις την
εντολή:

    gpg --help

Σε περίπτωση που τρέξει, το gpg είναι εγκατεστημένο.

Διαφορετικά, εγκατάστησέ το με τον package manager σου, για παράδειγμα:

    sudo apt-get install gnupg

### Windows
Για τα Windows θα πρέπει να κατεβάσεις το
[Gpg4win](http://www.gpg4win.org/download.html) και να το εγκαταστήσεις.
Στη συνέχεια μπορείς να το τρέξεις με την εντολή `gpg` μέσα από την κονσόλα
των Windows (`cmd.exe`).

### Mac
Για το Mac θα πρέπει να κατεβάσεις το [GPGTools](https://gpgtools.org).
Κατέβασε το GPG Suite (και όχι το GPGMail).

## Δημιουργία κλειδιού
Φτιάξε ένα GPG κλειδί:

    gpg --gen-key

Ακολούθησε τις σημερινές καλές πρακτικές:

1. Τύπος: **RSA/RSA**
1. Μέγεθος: **4096 bits**
1. Χρησιμοποίησε το **πραγματικό σου όνομα** με λατινικούς χαρακτήρες.
1. Χρησιμοποίησε το **προσωπικό σου e-mail**.
1. Χρησιμοποίησε ένα δυνατό passphrase με **τουλάχιστον 20 χαρακτήρες**.

Μπορείς να επιβεβαιώσεις ότι δημιούργησες το κλειδί σου επιτυχώς:

    gpg --list-secret-keys

Μπορείς επίσης να προβάλλεις το αποτύπωμα του κλειδιού σου:

    gpg --list-secret-keys --fingerprint

# Ρύθμισε το GPG σου
Είναι καλή πρακτική να χρησιμοποιείς SHA-256 ως αλγόριθμο κατακερματισμού στο GPG
(αντί για το προεπιλεγμένο SHA-1).

Μπορείς να το ρυθμίσεις αλλάζοντας το αρχείο `~/.gnupg/gpg.conf` σε Linux και Mac
ή το αρχείο `C:/Users/bob/AppData/Roaming/gnupg/gpg.conf` (όπου `bob` το όνομά σου)
σε Windows. Το αρχείο αυτό ενδεχομένως να μην υπάρχει, οπότε θα χρειαστεί να το
δημιουργήσεις.

    # Put your own key id here
    default-key AFB046C7
    keyserver pgp.mit.edu

    personal-digest-preferences SHA256
    cert-digest-algo SHA256
    default-preference-list SHA512 SHA384 SHA256 SHA224 AES256 AES192 AES CAST5 ZLIB BZIP2 ZIP Uncompressed

Στην πρώτη γραμμή τοποθέτησε το id του κλειδιού που μόλις δημιούργησες ώστε να
χρησιμοποιείται ως προεπιλογή.

Οι ρυθμίσεις επίσης περιλαμβάνουν τον MIT keyserver ώστε οι εντολές `--send-keys` και
`--recv-keys` να δουλεύουν χωρίς την παράμετρο `--keyserver`.

## Ανέβασμα κλειδιού
Ανέβασε το κλειδί σου στον keyserver:

    gpg --send-keys AFB046C7

Στη θέση του id πληκτρολόγησε το id του δικού σου κλειδιού.

## Κατέβασμα κλειδιού
Επικοινώνησε με ένα φίλο σου **που γνωρίζεις από πριν** και παρακολουθεί το σεμινάριο.
Κατέβασε το κλειδί του από τον keyserver αφότου το ανεβάσει:

    gpg --recv-keys 92BF1079

Στη θέση του 92BF1079 πληκτρολόγησε το id του κλειδιού του φίλου σου. Αυτό μπορείς να το βρεις
[αναζητώντας τον](http://pgp.mit.edu/) με το όνομά του ή με το e-mail του στον keyserver.

Μπορείς να επιβεβαιώσεις ότι έχεις κατεβάσει το κλειδί:

    gpg --list-keys
    gpg --list-keys 92BF1079
    gpg --list-keys Petros

Στην πρώτη περίπτωση εμφανίζουμε μία λίστα με όλα τα κλειδιά, ενώ παρακάτω εμφανίζουμε
ένα συγκεκριμένο κλειδί με βάση το id του ή το όνομα του κατόχου του.

Μπορείς επίσης να κατεβάσεις τα κλειδιά των διοργανωτών και των συνδιοργανωτών του
σεμιναρίου αναζητώντας τους με τα ονόματά τους. Φρόντισε τα κλειδιά που θα κατεβάσεις
να μην έχουν λήξει (ένδειξη *expired*) και να μην έχουν ανακληθεί (ένδειξη *revoked*).

Θα επιβεβαιώσεις ότι τα κλειδιά πραγματικά ανήκουν στα αναγραφόμενα φυσικά πρόσωπα
σε επόμενο βήμα — προς το παρόν αυτά τα κλειδιά δεν είναι άξια εμπιστοσύνης.

## Κρυπτογράφηση μηνύματος
Κρυπτογράφησε ένα μήνυμα και στείλ' το σε ένα από τα κλειδιά που κατέβασες:

    gpg --armor --encrypt --recipient Dionysis

Θα παρατηρήσεις μία προειδοποίηση σχετικά με απουσία επιβεβαίωσης της ταυτότητας του
κλειδιού. Αυτό θα λυθεί στο επόμενο βήμα.

Πληκτρολόγησε το μήνυμά σου και ολοκλήρωσέ το με enter και end-of-file:

* Ctrl + D σε Linux και Mac
* Ctrl + Z ακολουθούμενο από enter σε Windows

Στη συνέχεια, στείλε το μήνυμά σου στον παραλήπτη για τον οποίο το κρυπτογράφησες.

Προσπάθησε να αποκρυπτογραφήσεις το μήνυμα που κρυπτογράφησες για τον παραλήπτη και
παρατήρησε ότι κάτι τέτοιο είναι αδύνατο.

## Αποκρυπτογράφηση μηνύματος
Ζήτα από το συνεργάτη σου να κατεβάσει το κλειδί σου με `--recv-keys` και στη συνέχεια
να σου κρυπτογραφήσει ένα μήνυμα με `--encrypt`. Στη συνέχεια αποκρυπτογράφησέ το:

    gpg --decrypt

Κάνε επικόλληση το μήνυμα που έλαβες και πάτα enter και end-of-file για να δεις το
αποκρυπτογραφημένο μήνυμα.

Παρατήρησε ότι σου ζητείται το passphrase σου για να γίνει χρήση του ιδιωτικού σου
κλειδιού.

## Ψηφιακή υπογραφή
Υπόγραψε ψηφιακά ένα μήνυμα και στείλ' το σε ένα από τα κλειδιά που κατέβασες:

    gpg --clearsign

Ως συνήθως, ολοκλήρωσε το μήνυμά σου με enter και end-of-file.

Παρατήρησε ότι σου ζητείται το passphrase σου για να γίνει χρήση του ιδιωτικού σου
κλειδιού (εκτός αν έχει αποθηκευτεί προσωρινά σε περίπτωση που το ξαναχρησιμοποίησες
πρόσφατα).

Στείλε το υπογεγραμμένο σου μήνυμα στο συνεργάτη σου.

## Επιβεβαίωση υπογραφής
Ζήτα από το συνεργάτη σου να σου στείλει ένα ψηφιακά υπογεγραμμένο μήνυμα με `--clearsign`.
Στη συνέχεια επιβεβαίωσε την ψηφιακή του υπογραφή:

    gpg --verify

Κάνε επικόλληση το μήνυμα που έλαβες και πάτα enter και end-of-file. Θα πρέπει να δεις
τη φράση "Good signature".

Στη συνέχεια δοκίμασε να αλλάξεις μέρος του κειμένου. Είναι η υπογραφή ακόμη έγκυρη;

## Επιβεβαίωση ταυτότητας
Το σημαντικότερο κομμάτι του GPG είναι το web-of-trust. Χωρίς το web-of-trust, η κρυπτογράφηση
και οι ψηφιακές υπογραφές είναι άχρηστες. Γι' αυτό είναι σημαντικό να καταλάβεις πώς δουλεύει
και τι νόημα έχει η επιβεβαίωση ταυτότητας.

Για να δεις το αποτύπωμα του κλειδιού του αφού το κατεβάσεις με `--recv-keys`, 
πληκτρολόγησε:

    gpg --list-keys --fingerprint Dionysis

Όπου Dionysis το όνομα του συνεργάτη σου.

Εδώ είναι αυτά που πρέπει να κάνεις:

1. Συναντήσου **από κοντά** με το συνεργάτη σου.
    Δεν αρκεί μία συνομιλία μέσω chat, e-mail, ή Facebook. Μπορούν να παραποιηθούν με επίθεση man-in-the-middle.
1. Επιβεβαίωσε ότι το **πλήρες fingerprint** του κλειδιού του που εμφανίζεται στον υπολογιστή του ταιριάζει με αυτό που εσύ βλέπεις στα κλειδιά του μπρελόκ σου.
    Δεν αρκεί να επιβεώσεις μόνο το αναγνωριστικό του κλειδιού. Το αναγνωριστικό μπορεί να παραχαραχθεί.
1. Επιβεβαίωσε ότι **το όνομα και το επίθετο** στο κλειδί του είναι αυτά που ήδη γνωρίζεις.
1. Επιβεβαίωσε ότι το όνομά του και το επίθετό του είναι το σωστό σε ένα **επίσημο έγγραφο** όπως το διαβατήριό του που είναι δύσκολο να παραποιηθεί.
1. Επιβεβαίωσε ότι **η φωτογραφία** στο επίσημο έγγραφο που έλεγξες δείχνει τον άνθρωπο που ξέρεις.
1. Αν το κλειδί περιλαμβάνει φωτογραφία, επιβεβαίωσε ότι η φωτογραφία δείχνει τον άνθρωπο που ξέρεις.
    Μπορείς να το κάνεις χρησιμοποιώντας την εντολή `gpg --edit-key 92BF1079` όπου 92BF1079 το id του κλειδιού του συνεργάτη σου, και στη συνέχεια γράφοντας `showphoto`.
1. Επιβεβαίωσε ότι ο συνεργάτης σου έχει πρόσβαση σε όλες τις **e-mail διευθύνσεις** που αντιστοιχούν στο κλειδί.
    Μπορείς να το κάνεις στέλνοντάς του ένα e-mail το οποίο θα επιβεβαιώσεις ότι θα λάβει.

Αφού κάνεις τα παραπάνω, υπόγραψε ψηφιακά το δημόσιο κλειδί του:

    gpg --sign-key AFB046C7

Στη συνέχεια δημοσίευσε την υπογραφή σου:

    gpg --send-keys AFB046C7

Και στις δύο περιπτώσεις, το id του κλειδιού που γράφεις είναι το id του κλειδιού του συνεργάτη σου και όχι το δικό σου.
Με λίγα λόγια, στη θέση του AFB046C7 πληκτρολόγησε το κλειδί σου.

Έλεγξε στον keyserver ότι η υπογραφή σου έχει δημοσιευθεί μαζί με το κλειδί του συνεργάτη σου.

## Λάβε μία υπογραφή
Βάλε το συνεργάτη σου να υπογράψει ψηφιακά το κλειδί σου, όπως έκανες εσύ με το δικό του.
Επιβεβαίωσε ότι έλαβες μία υπογραφή στον keyserver.

Μπορείς να κατεβάσεις την υπογραφή του πάνω στο κλειδί σου κατεβάζοντας το κλειδί σου από τον keyserver:

    gpg --recv-keys AFB046C7

Παρατήρησε ότι το id του κλειδιού είναι το id του δικού σου κλειδού.

## Φτιάξε ένα revocation certificate
Σε περίπτωση που χρειαστεί να ανακαλέσεις το κλειδί σου, μπορείς να το κάνεις είτε έχοντας το ιδιωτικό σου
κλειδί, είτε με κάποιο **revocation certificate**. Αυτό είναι χρήσιμο σε περιπτωση που χάσεις το κλειδί σου
ή που το κλειδί σου πέσει σε λάθος χέρια.

Είναι χρήσιμο να φτιάξεις τώρα ένα revocation certificate για το κλειδί σου. Παρ' όλα αυτά, μην το χρησιμοποιήσεις,
καθώς δε θέλεις να ανακαλέσεις το κλειδί σου.

Τρέξε:

    gpg --output revoke.asc --gen-revoke AFB046C7

Στη θέση του id βάλε το id του κλειδιού σου. Αυτό θα δημιουργήσει το αρχείο revoke.asc. Κάνε ένα αντίγραφο και
κράτα το κάπου με ασφάλεια. Αυτό το αρχείο δεν θα ανακαλέσει το κλειδί σου ακόμη, αλλά αν το έχεις στην κατοχή σου
μπορείς να ανακαλέσεις το κλειδί σου.
